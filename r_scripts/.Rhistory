ylim = c(0,1)) +
theme(legend.position = 'none',
strip.text = element_text(hjust = 0, size = 8),#element_text(face = 'bold',hjust = 0, size = 8,
# margin = margin(t = 0, r = 20, b = 1, l = 0, unit = 'mm')),
panel.grid = element_blank(),
panel.border = element_rect(colour = '#000000', fill = NA),
plot.margin = margin(t = 2),
axis.text = element_blank(),
axis.title = element_blank())
# modify reference map to show 3 species and 10 individuals
ref_dom3_map <-
reference1$assemblage_map[[1]]$census %>%
slice(7:16) %>%
mutate(species = as.character(species),
species = ifelse(species == 'species4', 'species1', species)) %>%
mutate(assemblage = 'Reference') %>%
ggplot() +
facet_wrap(~assemblage, labeller = label_wrap_gen()) +
geom_point(aes(x=x, y = y, colour = species),
size = 2.5, alpha = 0.8) +
scale_color_manual(values = spp_col) +
# scale_color_viridis_d(option = "inferno") +
theme_minimal() +
coord_fixed(xlim = c(0,1),
ylim = c(0,1)) +
theme(legend.position = 'none',
strip.text = element_text(hjust = 0, size = 8),#element_text(face = 'bold',hjust = 0, size = 8,
# margin = margin(t = 0, r = 20, b = 1, l = 0, unit = 'mm')),
panel.grid = element_blank(),
panel.border = element_rect(colour = '#000000', fill = NA),
plot.margin = margin(t = 2),
axis.text = element_blank(),
axis.title = element_blank())
dom3_ibr <-
bind_rows(reference1 %>%
unnest(ibr) %>%
slice(1:10) %>%
select(assemblage, n, spec_rarefied),
dom3_ass %>%
unnest(ibr) %>%
select(assemblage, n, spec_rarefied) %>%
mutate(assemblage = 'More individuals, less even SAD, more species')) %>%
ggplot() +
geom_line(aes(x = n, y = spec_rarefied,
colour = assemblage,
group = assemblage), size = 1.5, alpha = 0.66) +
geom_point(aes(x = max(n), y = max(spec_rarefied[which(assemblage=='More individuals, less even SAD, more species')]),
shape = 'dom3',
colour = 'More individuals, less even SAD, more species'),
size = 3, stroke = 1.5) +
scale_shape_manual(guide = F,
values = delta_shape) +
scale_colour_manual(values = c('Reference' = '#bdbdbd',
'More individuals, less even SAD, more species' = '#ffa600'),
name = '') +
scale_y_continuous(breaks = c(2,4,6,8,10)) +
labs(x = 'Individuals',
y = 'Species') +
theme_minimal() +
coord_cartesian(clip = 'off') +
theme(panel.grid = element_blank(),
axis.line = element_line(colour = '#000000'),
axis.ticks = element_line(colour = '#000000'),
axis.title = element_text(size = 8),
legend.position = 'none', #c(0,1),
legend.justification = c(0,1),
legend.text = element_text(size = 8),
plot.margin = margin(t = 2, r = 2))
r1 <- plot_grid(ref_MIH_map, MIH_map,
mih_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r2 <- plot_grid(ref_map, rare_map, rare_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r3 <- plot_grid(ref_map, even_map, even_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r4 <- plot_grid(ref_map, dom_map, dom_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r5 <- plot_grid(ref_map, dom2_map, dom2_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r6 <- plot_grid(ref_dom3_map, dom3_map, dom3_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
plot_grid(r1, r2, r3, r4, r5, r6,
nrow = 6,
labels = 'auto')
# what about effect sizes plot too?
metrics <- tibble(
# treatment metrics
treatment = c('individuals',
'rare',
'even',
'dom',
'dom2',
'dom3'),
N = c(as.numeric(MIH$N_gamma),
N_initial,
nrow(even_comm$census),
nrow(dominance_ass$census),
as.numeric(dom2_ass$N_gamma),
as.numeric(dom3_ass$N_gamma)),
S = c(as.numeric(MIH$S_gamma),
as.numeric(rare_ass$S_gamma),
n_distinct(even_comm$census$species),
n_distinct(dominance_ass$census$species),
as.numeric(dom2_ass$S_gamma),
as.numeric(dom3_ass$S_gamma)),
ENSPIE = c(as.numeric(MIH$ENSPIE_gamma),
as.numeric(rare_ass$ENSPIE_gamma),
vegan::diversity(as.numeric(community_to_sad(even_comm)), index = 'invsimpson'),
vegan::diversity(as.numeric(community_to_sad(dominance_ass)), index = 'invsimpson'),
as.numeric(dom2_ass$ENSPIE_gamma),
as.numeric(dom3_ass$ENSPIE_gamma)),
S_ref_n = c(MIH$ibr[[1]][11,'spec_rarefied'],
rare_ass$ibr[[1]][N_initial,'spec_rarefied'],
as.numeric(vegan::rarefy(as.numeric(community_to_sad(even_comm)), sample = N_initial)),
as.numeric(vegan::rarefy(as.numeric(community_to_sad(dominance_ass)), sample = N_initial)),
dom2_ass$ibr[[1]][N_initial, 'spec_rarefied'],
dom3_ass$ibr[[1]][10, 'spec_rarefied']),
# column for each of the metrics in the reference
N_ref = c(11, as.numeric(reference1$N_gamma), as.numeric(reference1$N_gamma), as.numeric(reference1$N_gamma),
as.numeric(reference1$N_gamma), 10),
S_ref = c(5, as.numeric(reference1$S_gamma), as.numeric(reference1$S_gamma), as.numeric(reference1$S_gamma),
as.numeric(reference1$S_gamma), 3),
ENSPIE_ref = c(as.numeric(MIH$ENSPIE_gamma), as.numeric(reference1$ENSPIE_gamma), as.numeric(reference1$ENSPIE_gamma),
as.numeric(reference1$ENSPIE_gamma), as.numeric(reference1$ENSPIE_gamma),as.numeric(reference1$ENSPIE_gamma)),
Sn_ref = c(MIH$ibr[[1]][11,'spec_rarefied'], reference1$ibr[[1]][N_initial,'spec_rarefied'], reference1$ibr[[1]][N_initial,'spec_rarefied'],
reference1$ibr[[1]][N_initial,'spec_rarefied'], reference1$ibr[[1]][N_initial,'spec_rarefied'], reference1$ibr[[1]][10,'spec_rarefied'])
)
ES <- metrics %>%
mutate(N_ES = log(N / N_ref),
S_ES = log(S / S_ref),
ENSPIE_ES = log(ENSPIE / ENSPIE_ref),
Sn_ES = log(S_ref_n / Sn_ref))
trt_col = c(
'individuals' = '#004b6e',
'rare' = '#4f5794',
'even' = '#a0579f',
'dom' = '#e65586',
'dom2' = '#ff7055',
'dom3' = '#ffa600')
S_N_ES_plot <-
ggplot() +
geom_point(data = ES %>%
filter(treatment!='reference'),
aes(x = N_ES, y = S_ES, colour = treatment, shape = treatment),
size = 3, alpha = 1, stroke = 1.5,
position = position_jitter(width = 0.0025, height = 0.0025)) +
# geom_point(data = ES %>%
#              filter(treatment!='reference'),
#            aes(x = -1 * N_ES, y = -1 * S_ES, colour = treatment, shape = treatment),
#            size = 3, alpha = 1, stroke = 1.5,
#            position = position_jitter(width = 0.0025, height = 0.0025)) +
annotate(geom = 'text',
label = expression(paste(Delta, italic(S))),
x = 0, y = Inf, parse = T,
hjust = 1.25, vjust = 1) +
annotate(geom = 'text',
label = expression(paste(Delta, italic(N))),
x = Inf, y = 0, parse = T,
hjust = 0.5,
vjust = 1.25
) +
scale_color_manual(guide = FALSE,
values = trt_col) +
scale_shape_manual(guide = F, values = delta_shape) +
geom_vline(xintercept = 0, lty = 2, colour = '#bdbdbd') +
geom_hline(yintercept = 0, lty = 2, colour = '#bdbdbd') +
geom_abline(intercept = 0, slope = 1, lty = 2, colour = '#bdbdbd') +
scale_x_continuous(name = '', breaks = c(0)) +
scale_y_continuous(name = '', breaks = c(0)) +
# labs(x = 'Change in total abundance',
#      y = 'Change in species richness') +
coord_cartesian(clip = 'off') +
theme_minimal() +
theme(axis.title = element_text(size = 8),
plot.margin = margin(t = 8, r = 3, b = 3, l = 8, unit = 'mm'))
S_Sn_ES_plot <-
ggplot() +
geom_point(data = ES %>%
filter(treatment!='reference'),
aes(x = Sn_ES, y = S_ES, colour = treatment, shape = treatment),
size = 3, alpha = 1, stroke = 1.5,
position = position_jitter(width = 0.0025, height = 0.0025)) +
# geom_point(data = ES %>%
#              filter(treatment!='reference'),
#            aes(x = -1 * Sn_ES, y = -1 * S_ES, colour = treatment, shape = treatment),
#            size = 3, alpha = 1, stroke = 1.5,
#            position = position_jitter(width = 0.0025, height = 0.0025)) +
annotate(geom = 'text',
label = expression(paste(Delta, italic(S))),
x = 0, y = Inf, parse = T,
hjust = 1.25, vjust = 1) +
annotate(geom = 'text',
label = expression(paste(Delta, italic(S)[n])),
x = Inf, y = 0, parse = T,
hjust = 1,
vjust = 1.25
) +
scale_color_manual(guide = FALSE,
values = trt_col) +
scale_shape_manual(guide = F, values = delta_shape) +
geom_vline(xintercept = 0, lty = 2, colour = '#bdbdbd') +
geom_hline(yintercept = 0, lty = 2, colour = '#bdbdbd') +
geom_abline(intercept = 0, slope = 1, lty = 2, colour = '#bdbdbd') +
scale_x_continuous(name = '', breaks = c(0)) +
scale_y_continuous(name = '', breaks = c(0)) +
# labs(x = 'Change in rarefied richness',
#      y = 'Change in species richness') +
coord_cartesian(clip = 'off') +
theme_minimal() +
theme(axis.title = element_text(size = 8),
plot.margin = margin(t = 8, r = 3, b = 3, l = 8, unit = 'mm'))
S_S_PIE_ES_plot <-
ggplot() +
geom_point(data = ES %>%
filter(treatment!='reference'),
aes(x = ENSPIE_ES, y = S_ES, colour = treatment, shape = treatment),
size = 3, alpha = 1, stroke = 1.5,
position = position_jitter(width = 0.0025, height = 0.0025)) +
# geom_point(data = ES %>%
#              filter(treatment!='reference'),
#            aes(x = -1 * ENSPIE_ES, y = -1 * S_ES, colour = treatment, shape = treatment),
#            size = 3, alpha = 1, stroke = 1.5,
#            position = position_jitter(width = 0.0025, height = 0.0025)) +
scale_shape_manual(values = delta_shape, guide = F) +
scale_color_manual(guide = FALSE,
values = trt_col) +
annotate(geom = 'text',
label = expression(paste(Delta, italic(S))),
x = 0, y = Inf, parse = T,
hjust = 1.25, vjust = 1) +
annotate(geom = 'text',
label = expression(paste(Delta, italic(S)[PIE])),
x = Inf, y = 0, parse = T,
hjust = 1,
vjust = 1.25
) +
geom_vline(xintercept = 0, lty = 2, colour = '#bdbdbd') +
geom_hline(yintercept = 0, lty = 2, colour = '#bdbdbd') +
geom_abline(intercept = 0, slope = 1, lty = 2, colour = '#bdbdbd') +
scale_x_continuous(name = '', breaks = c(0)) +
scale_y_continuous(name = '', breaks = c(0)) +
# labs(x = 'Change in evenness',
# y = 'Change in species richness') +
coord_cartesian(clip = 'off') +
theme_minimal() +
theme(axis.title = element_text(size = 8),
plot.margin = margin(t = 8, r = 3, b = 3, l = 8, unit = 'mm'))
label1 = substitute(paste(Delta, 'richness', ' ~ ', #italic(f),
Delta, 'individuals'))
label2 = substitute(paste(Delta, 'richness', ' ~ ', #italic(f),
Delta, 'rarefied richness'))
label3 = substitute(paste(Delta, 'richness', ' ~ ', #italic(f),
Delta, 'evenness'))
bottom <- cowplot::plot_grid(NULL, S_N_ES_plot +
draw_label(label = label1, fontface = 'bold',
x = -Inf, y = Inf,
hjust = 0.2, vjust = -0.5, lineheight = 1, size = 10),
S_Sn_ES_plot +
draw_label(label = label2, fontface = 'bold',
x = -Inf, y = Inf,
hjust = 0.1, vjust = -0.5, lineheight = 1, size = 10),
S_S_PIE_ES_plot +
draw_label(label = label3,
x = -Inf, y = Inf,
hjust = 0.3, vjust = -0.5, lineheight = 1, size = 10,
fontface = 'bold' ), NULL,
nrow = 1, rel_widths = c(0.3,1,1,1,0.3),
labels = c('', 'g', 'h', 'i', ''))
top = plot_grid(r1, r2, r3,
r4, r5, r6,
nrow = 3, ncol = 2,
labels = 'auto',
align = 'hv')
plot_grid(bottom,
top, nrow = 2, rel_heights = c(3/7, 1))
bottom <- cowplot::plot_grid(NULL, S_N_ES_plot +
draw_label(label = label1, fontface = 'bold',
x = -Inf, y = Inf,
hjust = 0.2, vjust = -0.5, lineheight = 1, size = 10),
S_Sn_ES_plot +
draw_label(label = label2, fontface = 'bold',
x = -Inf, y = Inf,
hjust = 0.1, vjust = -0.5, lineheight = 1, size = 10),
S_S_PIE_ES_plot +
draw_label(label = label3,
x = -Inf, y = Inf,
hjust = 0.3, vjust = -0.5, lineheight = 1, size = 10,
fontface = 'bold' ), NULL,
nrow = 1, rel_widths = c(0.3,1,1,1,0.3),
labels = c('', 'a', 'b', 'c', ''))
bottom
plot_grid(r1, r2, r3, r4, r5, r6,
nrow = 6,
labels = c('d', 'e', 'f', 'g',
'h', 'i'))
top = plot_grid(r1, r2, r3,
r4, r5, r6,
nrow = 3, ncol = 2,
labels = c('d', 'e', 'f', 'g',
'h', 'i'),
align = 'hv')
plot_grid(bottom,
top, nrow = 2, rel_heights = c(3/7, 1))
ggsave('~/Dropbox/1current/multidimensionalChangeMS/Figs/Fig2_flip.png',
width = 290, height = 210, units = 'mm')
even_ibr <-
bind_rows(reference1 %>%
unnest(ibr) %>%
select(assemblage, n, spec_rarefied),
spec_sample_curve(even_comm, method = 'rarefaction') %>%
select(n, spec_rarefied) %>%
mutate(assemblage = 'Altered SAD')) %>%
ggplot() +
geom_line(aes(x = n, y = spec_rarefied,
colour = assemblage,
group = assemblage), size = 1.5, alpha = 0.66) +
geom_point(aes(x = max(n), y = max(spec_rarefied[which(assemblage=='More even assemblage')]),
shape = 'even', colour = 'More even assemblage'),
size = 3, stroke = 1.5) +
scale_shape_manual(guide = F,
values = delta_shape) +
scale_colour_manual(values = c('Reference' = '#bdbdbd',
'More even assemblage' = '#a0579f'),
name = '') +
# scale_y_continuous(breaks = c(1,3,5,7,9)) +
# scale_x_continuous(breaks = round(seq(1,30,length.out = 5))) +
labs(x = 'Individuals',
y = 'Species') +
coord_cartesian(clip = 'off') +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.line = element_line(colour = '#000000'),
axis.ticks = element_line(colour = '#000000'),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
legend.position = 'none', #c(0,1),
legend.justification = c(0,1),
legend.text = element_text(size = 8),
plot.margin = margin(t = 2, r = 2))
r3 <- plot_grid(ref_map, even_map, even_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r3
even_ibr
bind_rows(reference1 %>%
unnest(ibr) %>%
select(assemblage, n, spec_rarefied),
spec_sample_curve(even_comm, method = 'rarefaction') %>%
select(n, spec_rarefied) %>%
mutate(assemblage = 'Altered SAD'))
bind_rows(reference1 %>%
unnest(ibr) %>%
select(assemblage, n, spec_rarefied),
spec_sample_curve(even_comm, method = 'rarefaction') %>%
select(n, spec_rarefied) %>%
mutate(assemblage = 'Altered SAD')) %>% distinct(assemblage)
# even_ibr <-
bind_rows(reference1 %>%
unnest(ibr) %>%
select(assemblage, n, spec_rarefied),
spec_sample_curve(even_comm, method = 'rarefaction') %>%
select(n, spec_rarefied) %>%
mutate(assemblage = 'Altered SAD')) %>%
ggplot() +
geom_line(aes(x = n, y = spec_rarefied,
colour = assemblage,
group = assemblage), size = 1.5, alpha = 0.66) +
geom_point(aes(x = max(n), y = max(spec_rarefied[which(assemblage=='Altered SAD')]),
shape = 'even', colour = 'Altered SAD'),
size = 3, stroke = 1.5) +
scale_shape_manual(guide = F,
values = delta_shape) +
scale_colour_manual(values = c('Reference' = '#bdbdbd',
'Altered SAD' = '#a0579f'),
name = '') +
# scale_y_continuous(breaks = c(1,3,5,7,9)) +
# scale_x_continuous(breaks = round(seq(1,30,length.out = 5))) +
labs(x = 'Individuals',
y = 'Species') +
coord_cartesian(clip = 'off') +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.line = element_line(colour = '#000000'),
axis.ticks = element_line(colour = '#000000'),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
legend.position = 'none', #c(0,1),
legend.justification = c(0,1),
legend.text = element_text(size = 8),
plot.margin = margin(t = 2, r = 2))
even_ibr <-
bind_rows(reference1 %>%
unnest(ibr) %>%
select(assemblage, n, spec_rarefied),
spec_sample_curve(even_comm, method = 'rarefaction') %>%
select(n, spec_rarefied) %>%
mutate(assemblage = 'Altered SAD')) %>%
ggplot() +
geom_line(aes(x = n, y = spec_rarefied,
colour = assemblage,
group = assemblage), size = 1.5, alpha = 0.66) +
geom_point(aes(x = max(n), y = max(spec_rarefied[which(assemblage=='Altered SAD')]),
shape = 'even', colour = 'Altered SAD'),
size = 3, stroke = 1.5) +
scale_shape_manual(guide = F,
values = delta_shape) +
scale_colour_manual(values = c('Reference' = '#bdbdbd',
'Altered SAD' = '#a0579f'),
name = '') +
# scale_y_continuous(breaks = c(1,3,5,7,9)) +
# scale_x_continuous(breaks = round(seq(1,30,length.out = 5))) +
labs(x = 'Individuals',
y = 'Species') +
coord_cartesian(clip = 'off') +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.line = element_line(colour = '#000000'),
axis.ticks = element_line(colour = '#000000'),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
legend.position = 'none', #c(0,1),
legend.justification = c(0,1),
legend.text = element_text(size = 8),
plot.margin = margin(t = 2, r = 2))
r1 <- plot_grid(ref_MIH_map, MIH_map,
mih_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r2 <- plot_grid(ref_map, rare_map, rare_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r3 <- plot_grid(ref_map, even_map, even_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r4 <- plot_grid(ref_map, dom_map, dom_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r5 <- plot_grid(ref_map, dom2_map, dom2_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
r6 <- plot_grid(ref_dom3_map, dom3_map, dom3_ibr,
ncol = 3, rel_widths = c(1,1,1.2),
align = 'v', axis = 't')
plot_grid(r1, r2, r3, r4, r5, r6,
nrow = 6,
labels = c('d', 'e', 'f', 'g',
'h', 'i'))
source('~/Dropbox/1current/multidimensionalChangeMS/multiComponentChange/r_scripts/0_init_dirs_load_packages.R')
# spatial comparisons: land use change
load('~/Documents/work_localOnly/BioTIME_analyses/multiC_alpha/predicts_multi4a-6502421.Rdata')
ls()
PREDICTS_multi4_fit
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'newID')
library(brms)
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'newID')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'newID', resp = 'N')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'newID', resp = 'Ncorrected')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'SS', resp = 'Ncorrected')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'SS', resp = 'S', nsamples = 200)
ggsave(filename = '~/test_big_S_predicts.png',
width = 500, height = 500, units = 'mm')
library(tidyverse)
ggsave(filename = '~/test_big_S_predicts.png',
width = 500, height = 500, units = 'mm')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'LU', resp = 'Ncorrected', nsamples = 200)
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'LU', resp = 'Ncorrected', nsamples = 200, stat = 'median')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'LU', resp = 'S', nsamples = 200, stat = 'median')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'LU', resp = 'S', nsamples = 200, stat = 'median', binwidth = 1)
# spatial comparison: natural
load('~/Dropbox/1current/multidimensionalChangeMS/data_model_fits/spatial_natural_fit0_rPurschke.Rdata')
spatial_10sites0obsID
pp_check(spatial_10sites0obsID, resp = 'N',
type = 'stat_grouped', group = 'dataset_id', nsamples = 500)
pp_check(spatial_10sites0obsID, resp = 'N',
type = 'stat_grouped', group = 'dataset_id', nsamples = 500, stat = 'median')
pp_check(spatial_10sites0obsID, resp = 'S',
type = 'stat_grouped', group = 'dataset_id', nsamples = 500, stat = 'median')
pp_check(spatial_10sites0obsID, resp = 'Sn',
type = 'stat_grouped', group = 'dataset_id', nsamples = 500, stat = 'median')
pp_check(spatial_10sites0obsID, resp = 'ENSPIE',
type = 'stat_grouped', group = 'dataset_id', nsamples = 500, stat = 'median')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'SS', resp = 'ENSPIE', nsamples = 200, stat = 'median')
ggsave(filename = '~/Desktop/SS_pp_ENSPIE.png',
width = 500, height = 500, units = 'mm')
predicts_dat <- PREDICTS_multi4_fit$data %>%
as_tibble()
predicts_dat %>% distinct(SS)
predicts_dat %>% distinct(SS, LU) %>% data.frame()
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'Sn5', resp = 'ENSPIE', nsamples = 200, stat = 'median')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'Sn_5', resp = 'ENSPIE', nsamples = 200, stat = 'median')
pp_check(PREDICTS_multi4_fit, type = 'scatter_avg_grouped', group = 'SS', resp = 'Sn_5', nsamples = 200, stat = 'median')
pp_check(PREDICTS_multi4_fit, type = 'scatter_avg_grouped', group = 'SS', resp = 'Sn5', nsamples = 200, stat = 'median')
ggsave(filename = '~/Desktop/SS_pp_Sn.png',
width = 500, height = 500, units = 'mm')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped', group = 'LU', resp = 'Sn5', nsamples = 200, stat = 'median')
pp_check(PREDICTS_multi4_fit, type = 'stat_grouped',
group = 'SS', resp = 'Sn5',
nsamples = 200, stat = 'median') +
theme(strip.text = element_text(size = 6))
ggsave(filename = '~/Desktop/SS_pp_Sn.png',
width = 500, height = 500, units = 'mm')
rm(list=ls())
load('~/Documents/work_localOnly/BioTIME_analyses/multiC_alpha/multi4_pois2-6504373.Rdata')
ls()
multi4_fit$formula
pp_check(multi4_fit, type = 'stat_grouped', group = 'STUDY_ID', resp = 'N', nsamples = 200, stat = 'median')
